{%- from "calico/map.jinja" import etcd with context %}

exec /usr/bin/etcd --name="{{ etcd.fqdn }}"                                                         \
                   --advertise-client-urls="http://{{ etcd.ip }}:2379,http://{{ etcd.ip }}:4001"    \
                   --listen-client-urls="http://0.0.0.0:2379,http://0.0.0.0:4001"                   \
                   --listen-peer-urls "http://0.0.0.0:2380"                                         \
                   --initial-advertise-peer-urls "http://{{ etcd.ip }}:2380"                        \
                   --initial-cluster-token $(uuidgen)                                               \
                   --initial-cluster "{{ etcd.fqdn }}=http://{{ etcd.ip }}:2380"                    \
                   --initial-cluster-state "new"